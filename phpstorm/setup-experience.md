# Настройка PHP для работы

## Включение git stage (отмена changelists)

Для тех, кто пользуется PHPStorm и хотел попробовать новую фичу Git staging area - попробовал за вас. Докладываю.

С версии 2020.3 в PHPStorm появилась поддержка git staging area. Она выключает Changelist'ы, которые мне очень давно хотелось выключить (но кнопки такой не было), поэтому сразу решил попробовать эту фичу.

TL;DR: Попробовал. Enable staging area ПОКА НЕ ВКЛЮЧАТЬ.

С changelist'ами я борюсь давно, т. к. они очень мешают своей внезапностью: https://youtrack.jetbrains.com/issue/IDEA-194094

С версии 2020.3 можно включить Settings | Version Control | Git -> Enable staging area (если она задизаблена, нужно включить Version Control | Commit -> Use non modal commit interface). Staging area отменяет changelists.

Впечатления от работы примерно в течение недели с Git staging area: 

 * Changelist'ов действительно нет. 
 * Появились другие странные и неудобные вещи, некоторые связаны с Non modal commit dialog, некоторые со Staging area. 

Вопросы по Non modal commit dialog в принципе решаемы - там в основном о том, что окошки не там где раньше, галочки
не те и другие горячие клавиши надо нажимать. Например, diff теперь показывается в маленьком окошке редактора, и чтобы
открыть большое окно для просмотра изменений, нужно нажать Ctrl-D, когда курсор поставлен на список файлов в Commit dialog.
Дело привычки. И еще для новых файлов в окне diff нет галочки возле Your version, чтобы можно было исключить файл из коммита. Надеюсь, это баг и его поправят.

Staging area же реально мешает:

1. Когда переименовываешь файл (Shift-F6), шторм теперь два раза спрашивает: хотите удалить файл со старым именем из гит? А хотите теперь добавить новый? Брр. Надеюсь, это баг и его поправят.
2. Когда смотришь diff и вносишь правки (например, где-то дебаг убрать перед коммитом), то эти правки.. как бы...  они попадают не туда. То есть, они попадают в коммит, да. Но на диске их нет! И чтобы записать в реальные файлы те правки, которые ты вносил в окне diff, нужно что-то там дополнительно нажать. Ну такое. Нет, наверное, это как  раз и есть та самая суперфича staging area... но это точно не то, что я бы хотел использовать в ежедневном workflow.  Нет, ну надо же! Ты в файл правки внес, они в коммит попали, а у тебя в локальной копии их нет - это вообще зачем?  Надеюсь, это баг и его поправят. Хотя пока поддержка пишет, что так и должно быть - это же git staging area!
    
В итоге я уж лучше поживу со старыми Changelist'ами, тем более я уже давно привык справляться с их странным поведением. А staging area пускай допиливают.

## Non modal commit dialog

Переместить в удобное место (изначально при открытии замещает Project view, что неудобно): шестеранка -> Move to -> выбрать.

Удобное положение - Left Bottom.

## Проверка орфографии

1. Надо найти переписку с Василием Юров (зима? 2021), в ней мы пришли к приемлемому варианту, который работает сейчас (gnp).
2. Разработчики phpstorm [советуют](https://youtrack.jetbrains.com/issue/IDEA-261212#focus=Comments-27-4669378.0-0) использовать и инспекцию Typo, и Grammar aka Grazie  . Нет какого-то модуля, который бы был предназначен, чтобы заменить остальные. 

## Переключение проектов

https://youtrack.jetbrains.com/issue/IDEA-158396#focus=Comments-27-4670652.0-0 - совет про Frame switcher

## Автовыравнивание кода

* Code | Reformat file... - выключить Optimize Imports, иначе при автовыравнивании ФРАГМЕНТА кода все равно оптимизируются импорты, даже если они не попадали в выделенный блок.
    * https://intellij-support.jetbrains.com/hc/en-us/requests/3268089
    * https://youtrack.jetbrains.com/issue/IDEA-260762