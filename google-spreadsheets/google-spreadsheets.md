# Google spreadsheets experience

## ARRAYFORMULA VLOOKUP для NAMED RANGES

Задача: нужно сделать vlookup по named range, причем вывести не одну колонку, а диапазон колонок внутри named range.

Дано: например, на данном листе создан named range "MY_NAMED_RANGE" как B2:F4 (то есть, в named range не включены первая колонка A, а также первый ряд таблицы):

|     | A     | B       | C    | D    | E    | F    |
|-----|-------|---------|------|------|------|------|
| 1   |       |         | 2018 | 2019 | 2020 | 2021 |
| 2   | some  | Chrome  | 117  | 182  | 91   | 92   |
| 3   | other | Firefox | 82   | 88   | 28   | 0    |
| 4   | data  | Edge    | 12   | 19   | 926  | -7   |

Требуется: на этом же или другом листе произвести поиск по ключу из колонки B и вывести строку таблицы в виде колонок C:F.

Формула:

```
=ARRAYFORMULA(VLOOKUP("Firefox"; MY_NAMED_RANGE; COLUMN($B:$E);FALSE))
```

Пояснения:

1. VLOOKUP всегда ищет по первой колонке, поэтому и здесь он будет искать по первой колонке MY_NAMED_RANGE, (которая на листе является колонкой B). 
2. В качестве третьего аргумента указано `COLUMN(...)`. В `COLUMN` нужно указать диапазон колонок **относительно named range**. То есть, нам нужны со 2-й по 5-ю внутри named range. На листе это колонки C:F. Но **относительно named range** это будут колонки **B:E**. То есть, первая колонка named range считается за A, при обращении внутри VLOOKUP. Для стабильности при добавлении новых столбцов на лист, на котором находится формула, нужно указать индексы колонок через `$`. Итого:
   1. Нам нужны со 2-й по 5-ю колонки named range.
   2. 2 - это B, 5 - это E.
   3. Наш диапазон для указания в `COLUMN`: B:E.
   4. Но чтобы он не ломался при добавлении новых стобцов на листе с формулой, нужно указать его через `$`: $B:$E.
   5. На реальные индексы колонок на листе, где расположем named range, не обращаем внимания. 
   6. Результат: **$B:$E**. 

